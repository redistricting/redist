<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Inverse probability reweighting for MCMC Redistricting — redist.ipw • redist</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Inverse probability reweighting for MCMC Redistricting — redist.ipw" />
<meta property="og:description" content="redist.ipw properly weights and resamples simulated redistricting plans
so that the set of simulated plans resemble a random sample from the
underlying distribution. redist.ipw is used to correct the sample when
population parity, geographic compactness, or other constraints are
implemented." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">redist</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/redist.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/glossary.html">Glossary of Key Redistricting Terms</a>
    </li>
    <li>
      <a href="../articles/map-preproc.html">Map Pre-processing for Special Constraints</a>
    </li>
    <li>
      <a href="../articles/mcmc.html">Redistricting with Flip MCMC</a>
    </li>
    <li>
      <a href="../articles/mpi-slurm.html">MPI / Slurm Sample Scripts</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Releases</li>
    <li>
      <a href="https://alarm-redist.github.io/posts/2021-04-02-redist-300/">redist 3.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/alarm-redist/redist/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Inverse probability reweighting for MCMC Redistricting</h1>
    <small class="dont-index">Source: <a href='https://github.com/alarm-redist/redist/blob/master/R/redist_mcmc.R'><code>R/redist_mcmc.R</code></a></small>
    <div class="hidden name"><code>redist.ipw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>redist.ipw</code> properly weights and resamples simulated redistricting plans
so that the set of simulated plans resemble a random sample from the
underlying distribution. <code>redist.ipw</code> is used to correct the sample when
population parity, geographic compactness, or other constraints are
implemented.</p>
    </div>

    <pre class="usage"><span class='fu'>redist.ipw</span><span class='op'>(</span><span class='va'>algout</span>,
resampleconstraint <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pop"</span>, <span class='st'>"compact"</span>, <span class='st'>"segregation"</span>, <span class='st'>"similar"</span><span class='op'>)</span>,
<span class='va'>targetbeta</span>, targetpop <span class='op'>=</span> <span class='cn'>NULL</span>, temper <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>algout</th>
      <td><p>An object of class "redist".</p></td>
    </tr>
    <tr>
      <th>resampleconstraint</th>
      <td><p>The constraint implemented in the simulations: one
of "pop", "compact", "segregation", or "similar".</p></td>
    </tr>
    <tr>
      <th>targetbeta</th>
      <td><p>The target value of the constraint.</p></td>
    </tr>
    <tr>
      <th>targetpop</th>
      <td><p>The desired level of population parity. <code>targetpop</code> =
0.01 means that the desired distance from population parity is 1%. The
default is <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>temper</th>
      <td><p>A flag for whether simulated tempering was used to improve the
mixing of the Markov Chain. The default is <code>1</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>redist.ipw</code> returns an object of class "redist". The object
<code>redist</code> is a list that contains the following components (the
inclusion of some components is dependent on whether tempering
techniques are used):</p>
<dt>plans</dt><dd><p>Matrix of congressional district assignments generated by the
algorithm. Each row corresponds to a geographic unit, and each column
corresponds to a simulation.</p></dd>
<dt>distance_parity</dt><dd><p>Vector containing the maximum distance from parity for
a particular simulated redistricting plan.</p></dd>
<dt>mhdecisions</dt><dd><p>A vector specifying whether a proposed redistricting plan
was accepted (1) or rejected (0) in a given iteration.</p></dd>
<dt>mhprob</dt><dd><p>A vector containing the Metropolis-Hastings acceptance
probability for each iteration of the algorithm.</p></dd>
<dt>pparam</dt><dd><p>A vector containing the draw of the <code>p</code> parameter for each
simulation, which dictates the number of swaps attempted.</p></dd>
<dt>constraint_pop</dt><dd><p>A vector containing the value of the population
constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_compact</dt><dd><p>A vector containing the value of the compactness
constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_segregation</dt><dd><p>A vector containing the value of the
segregation constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_similar</dt><dd><p>A vector containing the value of the similarity
constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_vra</dt><dd><p>A vector containing the value of the
vra constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_partisan</dt><dd><p>A vector containing the value of the
partisan constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_minority</dt><dd><p>A vector containing the value of the
minority constraint for each accepted redistricting plan.</p></dd>
<dt>constraint_hinge</dt><dd><p>A vector containing the value of the
hinge constraint for each accepted redistricting plan.</p></dd>
<dt>beta_sequence</dt><dd><p>A vector containing the value of beta for each iteration
of the algorithm. Returned when tempering is being used.</p></dd>
<dt>mhdecisions_beta</dt><dd><p>A vector specifying whether a proposed beta value was
accepted (1) or rejected (0) in a given iteration of the algorithm. Returned
when tempering is being used.</p></dd>
<dt>mhprob_beta</dt><dd><p>A vector containing the Metropolis-Hastings acceptance
probability for each iteration of the algorithm. Returned when tempering
is being used.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function allows users to resample redistricting plans using
inverse probability weighting techniques described in Rubin (1987). This
techniques reweights and resamples redistricting plans so that the resulting
sample is representative of a random sample from the uniform distribution.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Fifield, Benjamin, Michael Higgins, Kosuke Imai and Alexander
Tarr. (2016) "A New Automated Redistricting Simulator Using Markov Chain
Monte Carlo." Working Paper.
Available at <a href='http://imai.princeton.edu/research/files/redist.pdf'>http://imai.princeton.edu/research/files/redist.pdf</a>.</p>
<p>Rubin, Donald. (1987) "Comment: A Noniterative Sampling/Importance Resampling
Alternative to the Data Augmentation Algorithm for Creating a Few Imputations
when Fractions of Missing Information are Modest: the SIR Algorithm."
Journal of the American Statistical Association.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>fl25</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>fl25_enum</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>fl25_adj</span><span class='op'>)</span>

<span class='co'>## Code to run the simulations in Figure 4 of Fifield, Higgins,</span>
<span class='co'>## Imai and Tarr (2015)</span>

<span class='co'>## Get an initial partition</span>
<span class='va'>init_plan</span> <span class='op'>&lt;-</span> <span class='va'>fl25_enum</span><span class='op'>$</span><span class='va'>plans</span><span class='op'>[</span>, <span class='fl'>5118</span><span class='op'>]</span>

<span class='co'>## Vector of beta weights</span>
<span class='va'>betaweights</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='fl'>10</span><span class='op'>)</span>; <span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>{</span><span class='va'>betaweights</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fl'>4</span><span class='op'>^</span><span class='va'>i</span><span class='op'>}</span>

<span class='co'>## Run simulations - tempering population constraint</span>
<span class='va'>alg_253_20_st</span> <span class='op'>&lt;-</span> <span class='fu'><a href='redist.flip.html'>redist.flip</a></span><span class='op'>(</span>adj <span class='op'>=</span> <span class='va'>fl25_adj</span>, total_pop <span class='op'>=</span> <span class='va'>fl25</span><span class='op'>$</span><span class='va'>pop</span>,
                             init_plan <span class='op'>=</span> <span class='va'>init_plan</span>, nsims <span class='op'>=</span> <span class='fl'>10000</span>,
                             constraint <span class='op'>=</span> <span class='st'>'population'</span>, constraintweights <span class='op'>=</span> <span class='fl'>5.4</span>,
                             betaweights <span class='op'>=</span> <span class='va'>betaweights</span>, temper <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'>## Resample using inverse probability weighting.</span>
<span class='co'>## Target distance from parity is 20%</span>
<span class='va'>alg_253_20_st</span> <span class='op'>&lt;-</span> <span class='fu'>redist.ipw</span><span class='op'>(</span><span class='va'>alg_253_20_st</span>, resampleconstraint <span class='op'>=</span> <span class='st'>"pop"</span>,
                            targetbeta <span class='op'>=</span> <span class='fl'>1</span>, targetpop <span class='op'>=</span> <span class='fl'>.2</span>, temper <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Christopher T. Kenny, Cory McCartan, Ben Fifield, Kosuke Imai.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


